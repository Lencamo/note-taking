## ä¸€ã€watch ç›‘å¬å™¨

### 1ã€ç®€ä»‹

æ¼”ç¤ºï¼š

```html
<div id="app">
  <input type="text" v-model="username" />
</div>

<script src="./lib/vue-2.6.14.js"></script>
<script>
  const vm = new Vue({
    el: '#app',
    data: {
      username: 'lencamo'
    },
    watch: {
      // æ³¨æ„å‚æ•°çš„é¡ºåºğŸš©
      username(newVal, oldVal) {
        console.log('å€¼' + oldVal + 'å‘ç”Ÿäº†æ”¹å˜ï¼ï¼\n' + 'æ–°å€¼ä¸ºï¼š' + newVal)
      }
    }
  })
</script>
```

æ€è€ƒï¼Ÿ

> ç›‘å¬æ˜¯çš„å˜åŒ–é¢‘ç‡ï¼š<span style="color: green">é˜²æŠ–</span> ä¸ <span style="color: green">èŠ‚æµ</span>

### 2ã€åº”ç”¨ â€”â€” ç›‘å¬ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨

#### â‘  æ–¹æ³•çš„å½¢å¼ï¼š

```html
<script>
  const vm = new Vue({
    el: '#app',
    data: {
      username: 'admin'
    },
    watch: {
      // 1ã€jQuery å†™æ³•
      username(newVal, oldVal) {
        if (newVal === '') return
        // ä½¿ç”¨jQueryå‘èµ·ajaxè¯·æ±‚ï¼Œåˆ¤æ–­usernameæ˜¯å¦è¢«å ç”¨
        $.get(
          'https://www.escook.cn/api/finduser/' + newVal,
          function (result) {
            console.log(result)
          }
        )
      }

      // 2ã€axios å†™æ³•
      async username(newVal, oldVal) {
        if (newVal === '') return
        // ä½¿ç”¨axioså‘èµ·ajaxè¯·æ±‚ï¼Œåˆ¤æ–­usernameæ˜¯å¦è¢«å ç”¨
        const { data: res } = await axios({
          method: 'GET',
          url: 'https://www.escook.cn/api/finduser/' + newVal
        })
        console.log(res)

        // axiosæ–¹æ³•å¾—åˆ°çš„è¿”å›å€¼æ˜¯ğŸš©Promiseå¯¹è±¡
        // ã€{data: {â€¦}, status: 200, statusText: 'OK', headers: {â€¦}, config: {â€¦},Â â€¦}ã€‘

        // await axios({
        //   method: "GET",
        //   url: "https://www.escook.cn/api/finduser/" + newVal,
        // }).then((result) => {
        //   console.log(result);
        // });
      }
    }
  })
</script>
```

#### â‘¡ å¯¹è±¡çš„å½¢å¼

```html
<script>
  const vm = new Vue({
    el: '#app',
    data: {
      username: 'admin'
    },
    watch: {
      // 1ã€jQuery å†™æ³•
      username: function (newVal, oldVal) {
        if (newVal === '') return
        $.get(
          'https://www.escook.cn/api/finduser/' + newVal,
          function (result) {
            console.log(result)
          }
        )
      }

      // 2ã€axios å†™æ³•
      username: {
        // handle æ˜¯âœ¨å›ºå®šå†™æ³•ï¼Œè¡¨ç¤ºå½“usernameå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨handerå¤„ç†å‡½æ•°
        handler: async function (newVal, oldVal) {
          if (newVal === '') return
          const { data: res } = await axios({
            method: 'GET',
            url: 'https://www.escook.cn/api/finduser/' + newVal
          })
          console.log(res)
        }
      }
    }
  })
</script>
```

### 3ã€æ‹“å±•

#### â‘  immediate é€‰é¡¹

&emsp;é»˜è®¤æƒ…å†µä¸‹ï¼Œç»„ä»¶åœ¨åˆæ¬¡åŠ è½½å®Œæ¯•æ—¶ä¸ä¼šè°ƒç”¨ watch ç›‘å¬å™¨(å³ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ é¦–æ¬¡æ˜¯ä¸ä¼šç›‘å¬ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨çš„)ã€‚

```js
// åˆæ¬¡åŠ è½½æ—¶å°±è¿›è¡Œç›‘å¬
watch: {
  username: {
    handler: async function (newVal) {}

    immediate: true
  }
}
```

#### â‘¡ deep é€‰é¡¹

&emsp;&emsp;å½“ watch ç›‘å¬çš„æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå½“å¯¹è±¡çš„å±æ€§å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæ˜¯æ— æ³•è¢«ç›‘å¬åˆ°çš„ã€‚

```html
// ç›‘å¬å¯¹è±¡å±æ€§å€¼å˜åŒ–
<script>
  const vm = new Vue({
    el: '#app',
    data: {
    brand: {
      id: 1,
      brandName: 'lisi',
      status: true,
      companyName: 'äº¬ä¸œ'
    }
  }
  watch: {
    brand: {
      handler: async function (newVal) {
        â€¦â€¦
        console.log(newVal.brandName)
        console.log(newVal.status)
      }

      deep: true
    }
  }
  })
</script>
```

&emsp;&emsp;å½“ç„¶å¦‚æœä¸ä½¿ç”¨ deep é€‰é¡¹ï¼Œæ˜¯å®Œå…¨å¯ä»¥ç›´æ¥ç›‘å¬å•ä¸ªå¯¹è±¡å±æ€§å€¼å˜åŒ–çš„ã€‚

```js
// ç›‘å¬å•ä¸ªå¯¹è±¡å±æ€§å€¼å˜åŒ–
watch: {
  'brand.brandName': {
    handler: async function (newVal) {
      â€¦â€¦
      console.log(newVal)
    }
  }
}
```

## äºŒã€è®¡ç®—å±æ€§

&emsp;&emsp;è®¡ç®—å±æ€§æ˜¯æŒ‡é€šè¿‡ä¸€ç³»åˆ—è¿ç®—ä¹‹åï¼Œæœ€ç»ˆå¾—åˆ°çš„ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§å€¼ã€‚

### é¢œè‰²ç›‘å¬æ¡ˆä¾‹

- ä¼ ç»Ÿæ–¹å¼

```html
<body>
  <div id="app">
    <div>
      <span>Rï¼š</span>
      <input type="text" v-model.number="r" />
    </div>
    <div>
      <span>Gï¼š</span>
      <input type="text" v-model.number="g" />
    </div>
    <div>
      <span>Bï¼š</span>
      <input type="text" v-model.number="b" />
    </div>

    <hr />
    <!-- å¸¸è§„å†™æ³•ï¼ˆä½¿ç”¨æ¨¡å—âœ¨å­—ç¬¦ä¸²ï¼‰ -->
    <div
      class="box"
      :style="{ backgroundColor: `rgb(${r}, ${g}, ${b})` }"
    ></div>
  </div>

  <script src="./lib/vue-2.6.14.js"></script>
  <script src="./lib/jquery v1.12.4.js"></script>
  <script>
    const vm = new Vue({
      el: '#app',
      data: {
        r: 0,
        g: 0,
        b: 0
      }
    })
  </script>
</body>
```

- è®¡ç®—æœºå±æ€§æ–¹å¼

```html
<body>
  <div id="app">
    <div>
      <span>Rï¼š</span>
      <input type="text" v-model.number="r" />
    </div>
    <div>
      <span>Gï¼š</span>
      <input type="text" v-model.number="g" />
    </div>
    <div>
      <span>Bï¼š</span>
      <input type="text" v-model.number="b" />
    </div>

    <hr />
    <!-- ä½¿ç”¨è®¡ç®—å±æ€§ -->
    <div class="box" :style="{backgroundColor: rgb}"></div>
  </div>

  <script src="./lib/vue-2.6.14.js"></script>
  <script src="./lib/jquery v1.12.4.js"></script>
  <script>
    const vm = new Vue({
      el: '#app',
      data: {
        r: 0,
        g: 0,
        b: 0
      },
      computed: {
        rgb() {
          return `rgb(${this.r}, ${this.g}, ${this.b})`
        }
      }
    })
  </script>
</body>
```

## ä¸‰ã€ç›‘å¬å™¨å’Œè®¡ç®—å±æ€§çš„å¯¹æ¯”

```html
<div id="demo">{{ fullName }}</div>
```

- ç›‘å¬å™¨çš„æ–¹å¼

```html
<script>
  var vm = new Vue({
    el: '#demo',
    data: {
      firstName: 'Foo',
      lastName: 'Bar',
      fullName: 'Foo Bar'
    },
    watch: {
      firstName: function (val) {
        this.fullName = val + ' ' + this.lastName
      },
      lastName: function (val) {
        this.fullName = this.firstName + ' ' + val
      }
    }
  })
</script>
```

> ç›‘å¬æ•°æ®å˜åŒ–

- è®¡ç®—å±æ€§çš„æ–¹å¼

```html
<script>
  var vm = new Vue({
    el: '#demo',
    data: {
      firstName: 'Foo',
      lastName: 'Bar'
    },
    computed: {
      fullName: function () {
        return this.firstName + ' ' + this.lastName
      }
    }
  })
</script>
```

> <span style="color: green">ä»£ç å¤ç”¨</span>ã€ç›‘å¬æ•°æ®å˜åŒ–
